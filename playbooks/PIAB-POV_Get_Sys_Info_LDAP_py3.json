{
    "blockly": false,
    "blockly_xml": "<xml></xml>",
    "category": "Proof of Value",
    "coa": {
        "data": {
            "clean": true,
            "code_block": "\n",
            "description": "Requires the destinationHostName field to exist in artifacts. Then uses that to lookup ActiveDirectory, for system attributes. On success, adds the information to both the artifact, and general notes section.",
            "hash": "0c97bde69fab34e65ce2ba14f13c45208e989446",
            "joint": {
                "cells": [
                    {
                        "0": "S",
                        "1": "T",
                        "2": "A",
                        "3": "R",
                        "4": "T",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "ref-x": 33,
                                "ref-y": 8,
                                "text": "START"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "ref-x": 13,
                                "xlink:href": "/inc/coa/img/block_icon_start.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_start(container):\n    phantom.debug('on_start() called')\n    \n    # call 'cf_local_POV_set_event_owner_to_current_1' block\n    cf_local_POV_set_event_owner_to_current_1(container=container)\n\n    return\n",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "ef2cc378-31c1-4c53-9ac5-f8d512cc5c9a",
                        "inPorts": [],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 16,
                        "line_start": 8,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 1,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 0,
                            "y": 100
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "START",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 1
                    },
                    {
                        "0": "E",
                        "1": "N",
                        "2": "D",
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".title": {
                                "text": "END"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_end.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def on_finish(container, summary):\n    phantom.debug('on_finish() called')\n    # This function is called after all actions are completed.\n    # summary of all the action and/or all details of actions\n    # can be collected here.\n\n    # summary_json = phantom.get_summary()\n    # if 'result' in summary_json:\n        # for action_result in summary_json['result']:\n            # if 'action_run_id' in action_result:\n                # action_results = phantom.get_action_results(action_run_id=action_result['action_run_id'], result_data=False, flatten=False)\n                # phantom.debug(action_results)\n\n    return\n",
                        "callback_code": "# read-only block view not available",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "TaskComplete, POV_get_current_task, CompleteTaskNoArtifacts, CompleteTaskError",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "29c6996e-3cb2-4a94-8ecc-bc5076151a5f",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "# read-only block view not available",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 517,
                        "line_start": 504,
                        "name": "",
                        "notes": "",
                        "number": 0,
                        "order": 18,
                        "outPorts": [],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1460,
                            "y": 300
                        },
                        "previous_function": "",
                        "previous_name": "",
                        "show_number": true,
                        "size": {
                            "height": 54,
                            "width": 80
                        },
                        "status": "",
                        "title": "END",
                        "type": "coa.StartEnd",
                        "warn": false,
                        "z": 2
                    },
                    {
                        ".scmName/text": "local",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".customFunction": {
                                "text": "POV_set_event_owner_to..."
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            ".title-info": {
                                "text": ""
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def cf_local_POV_set_event_owner_to_current_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('cf_local_POV_set_event_owner_to_current_1() called')\n    \n    container_property_0 = [\n        [\n            container.get(\"id\"),\n        ],\n    ]\n\n    parameters = []\n\n    container_property_0_0 = [item[0] for item in container_property_0]\n\n    parameters.append({\n        'container': container_property_0_0,\n    })\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################    \n\n    # call custom function \"local/POV_set_event_owner_to_current\", returns the custom_function_run_id\n    phantom.custom_function(custom_function='local/POV_set_event_owner_to_current', parameters=parameters, name='cf_local_POV_set_event_owner_to_current_1', callback=cf_local_POV_get_current_task_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "cfDisplayPath": "local/POV_set_event_owner_to_current",
                        "cfInputs": {
                            "container": {
                                "collectionType": "container_property",
                                "dataPath": "container:id",
                                "paramName": "container_property_0_0",
                                "type": "list"
                            }
                        },
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "",
                        "connection_type": "",
                        "container-0": "container:id",
                        "currentVersion": true,
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 19,
                        "customFunction": "local/POV_set_event_owner_to_current",
                        "customFunctionId": null,
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "draftMode": false,
                        "existingCF": true,
                        "functionBlock": "custom function",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "a45902aa-8a41-4f00-883d-ff42af09c429",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 47,
                        "line_start": 16,
                        "message": "Configuring now",
                        "name": "POV_set_event_owner_to_current",
                        "notes": "",
                        "number": 1,
                        "order": 2,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 120,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "cf_local_POV_set_event_owner_to_current_1",
                        "selectedCustomFunction": {
                            "description": "Grabs the user running the playbook and sets the owner of the event to the current user. Passes current_owner out for downstream use.\n\nDerek King  - Splunk",
                            "draftMode": false,
                            "id": 363,
                            "inputs": [
                                {
                                    "_pretty_custom_function": "POV_set_event_owner_to_current",
                                    "contains_type": [
                                        "phantom container id"
                                    ],
                                    "custom_function": 363,
                                    "description": "Container id",
                                    "id": 929,
                                    "input_type": "list",
                                    "name": "container",
                                    "placeholder": "id"
                                }
                            ],
                            "name": "POV_set_event_owner_to_current",
                            "outputs": [
                                {
                                    "_pretty_custom_function": "POV_set_event_owner_to_current",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 363,
                                    "data_path": "currentOwner",
                                    "description": "Current owner running the playbook",
                                    "id": 1205
                                },
                                {
                                    "_pretty_custom_function": "POV_set_event_owner_to_current",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 363,
                                    "data_path": "userUrl",
                                    "description": "",
                                    "id": 1206
                                },
                                {
                                    "_pretty_custom_function": "POV_set_event_owner_to_current",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 363,
                                    "data_path": "status",
                                    "description": "",
                                    "id": 1207
                                },
                                {
                                    "_pretty_custom_function": "POV_set_event_owner_to_current",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 363,
                                    "data_path": "message",
                                    "description": "",
                                    "id": 1208
                                },
                                {
                                    "_pretty_custom_function": "POV_set_event_owner_to_current",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 363,
                                    "data_path": "username",
                                    "description": "",
                                    "id": 1209
                                }
                            ],
                            "playbooks": {
                                "draft_playbooks": [],
                                "draft_version_id": null,
                                "playbooks": [
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Close_Splunk_ES_Notable",
                                        "draft_mode": false,
                                        "id": 1042,
                                        "name": "POV_Close_Splunk_ES_Notable",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/Excessive_Failed_Logons_util",
                                        "draft_mode": false,
                                        "id": 1080,
                                        "name": "Excessive_Failed_Logons_util",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Sinkhole_or_Block_External_Indicators",
                                        "draft_mode": false,
                                        "id": 1316,
                                        "name": "POV_Sinkhole_or_Block_External_Indicators",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_WinRM_Get_File",
                                        "draft_mode": false,
                                        "id": 1429,
                                        "name": "POV_WinRM_Get_File",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_EC2_AWS_Context",
                                        "draft_mode": false,
                                        "id": 1251,
                                        "name": "POV_EC2_AWS_Context",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Phishing_Network_Indicator_Enrichment",
                                        "draft_mode": false,
                                        "id": 1254,
                                        "name": "POV_Phishing_Network_Indicator_Enrichment",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Accept_Event",
                                        "draft_mode": false,
                                        "id": 1030,
                                        "name": "POV_Accept_Event",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Review_Indicators",
                                        "draft_mode": false,
                                        "id": 1360,
                                        "name": "POV_Review_Indicators",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_File_Reputation",
                                        "draft_mode": false,
                                        "id": 1441,
                                        "name": "POV_File_Reputation",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Detonate_Executable_File",
                                        "draft_mode": false,
                                        "id": 1442,
                                        "name": "POV_Detonate_Executable_File",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_AddContext_LDAP",
                                        "draft_mode": false,
                                        "id": 1265,
                                        "name": "POV_AddContext_LDAP",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Excessive_Failed_Logons",
                                        "draft_mode": false,
                                        "id": 1027,
                                        "name": "POV_Excessive_Failed_Logons",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Hunt_Email_Indicators",
                                        "draft_mode": false,
                                        "id": 1311,
                                        "name": "POV_Hunt_Email_Indicators",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_EC2_Instance_Investigation",
                                        "draft_mode": false,
                                        "id": 994,
                                        "name": "POV_EC2_Instance_Investigation",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_EC2_Instance_Isolation",
                                        "draft_mode": false,
                                        "id": 998,
                                        "name": "POV_EC2_Instance_Isolation",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_EC2_Remote_Probe_Context",
                                        "draft_mode": false,
                                        "id": 970,
                                        "name": "POV_EC2_Remote_Probe_Context",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_malicious_insider_containment",
                                        "draft_mode": false,
                                        "id": 876,
                                        "name": "POV_malicious_insider_containment",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/Sinkhole or Block external indicators of compromise",
                                        "draft_mode": false,
                                        "id": 820,
                                        "name": "Sinkhole or Block external indicators of compromise",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/Hunt Indicators",
                                        "draft_mode": false,
                                        "id": 765,
                                        "name": "Hunt Indicators",
                                        "viewable": true
                                    }
                                ]
                            },
                            "scmId": 2,
                            "scmName": "local"
                        },
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "repo",
                        "status": "",
                        "title": "custom function",
                        "type": "coa.CustomFunctionBlock",
                        "userGeneratedCode": "    # Write your custom code here...\n",
                        "warn": false,
                        "z": 5
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "6c42581d-da4f-4c6b-89f8-84cf469dc8e5",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "a45902aa-8a41-4f00-883d-ff42af09c429",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "110af410-57dc-491e-b232-52bc6e7ead34",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 6
                    },
                    {
                        ".scmName/text": "local",
                        "active": false,
                        "active_keys": {},
                        "active_values": {},
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".customFunction": {
                                "text": "POV_get_current_task"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".scmName": {
                                "text": "local"
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            ".title-info": {
                                "text": ""
                            },
                            "g.branch image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            }
                        },
                        "block_code": "def cf_local_POV_get_current_task_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('cf_local_POV_get_current_task_1() called')\n    \n    custom_function_result_0 = phantom.collect2(container=container, datapath=['cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner'], action_results=results )\n    container_property_0 = [\n        [\n            container.get(\"id\"),\n        ],\n    ]\n\n    parameters = []\n\n    container_property_0_0 = [item[0] for item in container_property_0]\n    custom_function_result_0_0 = [item[0] for item in custom_function_result_0]\n\n    parameters.append({\n        'container': container_property_0_0,\n        'currentOwner': custom_function_result_0_0,\n    })\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################    \n\n    # call custom function \"local/POV_get_current_task\", returns the custom_function_run_id\n    phantom.custom_function(custom_function='local/POV_get_current_task', parameters=parameters, name='cf_local_POV_get_current_task_1', callback=decision_1)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "cfDisplayPath": "local/POV_get_current_task",
                        "cfInputs": {
                            "container": {
                                "collectionType": "container_property",
                                "dataPath": "container:id",
                                "paramName": "container_property_0_0",
                                "type": "list"
                            },
                            "currentOwner": {
                                "collectionType": "custom_function_result",
                                "dataPath": "cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner",
                                "paramName": "custom_function_result_0_0",
                                "type": "list"
                            }
                        },
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "POV_set_event_owner_to_current",
                        "connection_type": "action",
                        "container-0": "container:id",
                        "currentOwner-1": "cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner",
                        "currentVersion": true,
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 22,
                        "customFunction": "local/POV_get_current_task",
                        "customFunctionId": null,
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "delay": 0,
                        "description": "",
                        "draftMode": false,
                        "existingCF": true,
                        "functionBlock": "custom function",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "110af410-57dc-491e-b232-52bc6e7ead34",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 81,
                        "line_start": 47,
                        "message": "Configuring now",
                        "name": "POV_get_current_task",
                        "notes": "",
                        "number": 1,
                        "order": 3,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 340,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "cf_local_POV_get_current_task_1",
                        "selectedCustomFunction": {
                            "description": "Gets the current task in the phase, and returns the task_id, and current owner of the playbook",
                            "draftMode": false,
                            "id": 366,
                            "inputs": [
                                {
                                    "_pretty_custom_function": "POV_get_current_task",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 366,
                                    "description": "",
                                    "id": 934,
                                    "input_type": "list",
                                    "name": "container",
                                    "placeholder": "container:id"
                                },
                                {
                                    "_pretty_custom_function": "POV_get_current_task",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 366,
                                    "description": "",
                                    "id": 935,
                                    "input_type": "list",
                                    "name": "currentOwner",
                                    "placeholder": ""
                                }
                            ],
                            "name": "POV_get_current_task",
                            "outputs": [
                                {
                                    "_pretty_custom_function": "POV_get_current_task",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 366,
                                    "data_path": "task_body",
                                    "description": "",
                                    "id": 1226
                                },
                                {
                                    "_pretty_custom_function": "POV_get_current_task",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 366,
                                    "data_path": "task_id",
                                    "description": "",
                                    "id": 1227
                                },
                                {
                                    "_pretty_custom_function": "POV_get_current_task",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 366,
                                    "data_path": "next_playbook",
                                    "description": "",
                                    "id": 1228
                                },
                                {
                                    "_pretty_custom_function": "POV_get_current_task",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 366,
                                    "data_path": "workflow_task_url",
                                    "description": "",
                                    "id": 1229
                                },
                                {
                                    "_pretty_custom_function": "POV_get_current_task",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 366,
                                    "data_path": "status",
                                    "description": "",
                                    "id": 1230
                                },
                                {
                                    "_pretty_custom_function": "POV_get_current_task",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 366,
                                    "data_path": "message",
                                    "description": "",
                                    "id": 1231
                                },
                                {
                                    "_pretty_custom_function": "POV_get_current_task",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 366,
                                    "data_path": "task_name",
                                    "description": "Name of the Task in the workbook",
                                    "id": 1232
                                },
                                {
                                    "_pretty_custom_function": "POV_get_current_task",
                                    "contains_type": [
                                        "*"
                                    ],
                                    "custom_function": 366,
                                    "data_path": "current_playbook_name",
                                    "description": "This Playbook Executing Now.",
                                    "id": 1233
                                }
                            ],
                            "playbooks": {
                                "draft_playbooks": [],
                                "draft_version_id": null,
                                "playbooks": [
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Close_Splunk_ES_Notable",
                                        "draft_mode": false,
                                        "id": 1042,
                                        "name": "POV_Close_Splunk_ES_Notable",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/Excessive_Failed_Logons_util",
                                        "draft_mode": false,
                                        "id": 1080,
                                        "name": "Excessive_Failed_Logons_util",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Sinkhole_or_Block_External_Indicators",
                                        "draft_mode": false,
                                        "id": 1316,
                                        "name": "POV_Sinkhole_or_Block_External_Indicators",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_WinRM_Get_File",
                                        "draft_mode": false,
                                        "id": 1429,
                                        "name": "POV_WinRM_Get_File",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_EC2_AWS_Context",
                                        "draft_mode": false,
                                        "id": 1251,
                                        "name": "POV_EC2_AWS_Context",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Phishing_Network_Indicator_Enrichment",
                                        "draft_mode": false,
                                        "id": 1254,
                                        "name": "POV_Phishing_Network_Indicator_Enrichment",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Review_Indicators",
                                        "draft_mode": false,
                                        "id": 1360,
                                        "name": "POV_Review_Indicators",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Excessive_Failed_Logons",
                                        "draft_mode": false,
                                        "id": 1027,
                                        "name": "POV_Excessive_Failed_Logons",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_EC2_Instance_Investigation",
                                        "draft_mode": false,
                                        "id": 994,
                                        "name": "POV_EC2_Instance_Investigation",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_EC2_Instance_Isolation",
                                        "draft_mode": false,
                                        "id": 998,
                                        "name": "POV_EC2_Instance_Isolation",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Accept_Event",
                                        "draft_mode": false,
                                        "id": 1030,
                                        "name": "POV_Accept_Event",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_EC2_Remote_Probe_Context",
                                        "draft_mode": false,
                                        "id": 970,
                                        "name": "POV_EC2_Remote_Probe_Context",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_malicious_insider_containment",
                                        "draft_mode": false,
                                        "id": 876,
                                        "name": "POV_malicious_insider_containment",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_File_Reputation",
                                        "draft_mode": false,
                                        "id": 1441,
                                        "name": "POV_File_Reputation",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/Sinkhole or Block external indicators of compromise",
                                        "draft_mode": false,
                                        "id": 820,
                                        "name": "Sinkhole or Block external indicators of compromise",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/Hunt Indicators",
                                        "draft_mode": false,
                                        "id": 765,
                                        "name": "Hunt Indicators",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Detonate_Executable_File",
                                        "draft_mode": false,
                                        "id": 1442,
                                        "name": "POV_Detonate_Executable_File",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_Hunt_Email_Indicators",
                                        "draft_mode": false,
                                        "id": 1311,
                                        "name": "POV_Hunt_Email_Indicators",
                                        "viewable": true
                                    },
                                    {
                                        "active": false,
                                        "display_path": "local/POV_AddContext_LDAP",
                                        "draft_mode": false,
                                        "id": 1265,
                                        "name": "POV_AddContext_LDAP",
                                        "viewable": true
                                    }
                                ]
                            },
                            "scmId": 2,
                            "scmName": "local"
                        },
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "repo",
                        "status": "",
                        "title": "custom function",
                        "type": "coa.CustomFunctionBlock",
                        "userGeneratedCode": "    # Write your custom code here...\n",
                        "warn": false,
                        "z": 7
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "d6b33018-50c3-4eca-94f4-04117616edf7",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "110af410-57dc-491e-b232-52bc6e7ead34",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "7a8d1ecc-2812-44a6-8b42-b475956a857f",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 8
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#637282",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def decision_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('decision_1() called')\n\n    # check for 'if' condition 1\n    matched = phantom.decision(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"cf_local_POV_get_current_task_1:custom_function_result.data.status\", \"==\", \"failed\"],\n        ])\n\n    # call connected blocks if condition 1 matched\n    if matched:\n        TaskIdentError(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        return\n\n    # call connected blocks for 'else' condition 2\n    TaskInProgress(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "POV_get_current_task",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "hasElse": true,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "7a8d1ecc-2812-44a6-8b42-b475956a857f",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 102,
                        "line_start": 81,
                        "name": "decision",
                        "notes": "",
                        "number": 1,
                        "order": 4,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "cf_local_POV_get_current_task_1:custom_function_result.data.status",
                                        "value": "failed"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "",
                                        "value": ""
                                    }
                                ],
                                "display": "Else",
                                "logic": "and",
                                "type": "else"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 560,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "decision_1",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 9
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "cf804bb8-191f-4ad5-958e-c815dca5f60e",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "7a8d1ecc-2812-44a6-8b42-b475956a857f",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "6a1c06e3-ca68-420b-bd74-2cf6075f6803",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 10
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "3084dead-f184-4c3e-93e2-1022a493dd16",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "7a8d1ecc-2812-44a6-8b42-b475956a857f",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "4a84b156-761d-4097-b824-608905ca5b03",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 12
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "ee4be64e-dfff-4d43-b129-e1a1eb536b3a",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ea5f315e-8152-4ecc-9ee5-d850f072d3e7",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "cd287f6b-267a-4850-8c1d-3ed7023d941c",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 16
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "59aac545-fbc9-465d-a925-9cdd52720ee9",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ea5f315e-8152-4ecc-9ee5-d850f072d3e7",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "44f8a0bd-16c5-4c93-ac0b-1c5dd5b7d4d3",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 19
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "c21efc24-4d45-4e56-9cf7-5f8c696a5c97",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "44f8a0bd-16c5-4c93-ac0b-1c5dd5b7d4d3",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "3554520c-a0eb-4b51-90eb-53c5b399dd8b",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 21
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "fddce590-fb45-4075-8d2a-c74d3722b193",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "3554520c-a0eb-4b51-90eb-53c5b399dd8b",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "b99184a9-9c03-4deb-a2d2-a59f403a07e8",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 23
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "a8ba6a72-0ea6-4ae4-bff4-6cf68817fcf5",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "b99184a9-9c03-4deb-a2d2-a59f403a07e8",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "96d885c4-bbfb-42ca-84ff-4b96958ddd8c",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 28
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "698eccef-9875-4ed9-93af-68f200bbf25d",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "96d885c4-bbfb-42ca-84ff-4b96958ddd8c",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "928bdd2d-de1e-429f-9ffa-0f782e4b0377",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 35
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#637282",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 3
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def decision_3(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('decision_3() called')\n\n    # check for 'if' condition 1\n    matched = phantom.decision(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"getSystemAttrsLDAP:action_result.status\", \"==\", \"failed\"],\n        ])\n\n    # call connected blocks if condition 1 matched\n    if matched:\n        CompleteTaskError(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        return\n\n    # call connected blocks for 'else' condition 2\n    formatCefString(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n    formatGeneralNote(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "getSystemAttrsLDAP",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "hasElse": true,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "b99184a9-9c03-4deb-a2d2-a59f403a07e8",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 270,
                        "line_start": 248,
                        "name": "decision",
                        "notes": "",
                        "number": 3,
                        "order": 11,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "getSystemAttrsLDAP:action_result.status",
                                        "value": "failed"
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "",
                                        "value": ""
                                    }
                                ],
                                "display": "Else",
                                "logic": "and",
                                "type": "else"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 660,
                            "y": 340
                        },
                        "previous_function": "",
                        "previous_name": "decision_3",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 44
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f62638d6-1096-4b6e-b7b5-59b41af91b85",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "b99184a9-9c03-4deb-a2d2-a59f403a07e8",
                            "port": "out-2",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(2) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "1f698010-48b0-4d5c-a81b-ebc9e4556870",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 47
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "f635e66c-f56f-475b-926a-7cf497167478",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "ef2cc378-31c1-4c53-9ac5-f8d512cc5c9a",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "a45902aa-8a41-4f00-883d-ff42af09c429",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 49
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "0fca02d2-a596-4199-ba52-a42d3eafa671",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "4a84b156-761d-4097-b824-608905ca5b03",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "ea5f315e-8152-4ecc-9ee5-d850f072d3e7",
                            "port": "in",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 50
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".format": {
                                "text": "formatGeneralNote"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out-1": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out-1>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "format"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def formatGeneralNote(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('formatGeneralNote() called')\n    \n    template = \"\"\"## {0} - Actions ##\n\n** LDAP Status: **\n{1}\n\n|DNS Hostname|Operating System|ServicePack|OS Version|\n|---|---|---|---|\n| {2} | {3} | {4} | {5} |\"\"\"\n\n    # parameter list for template variable replacement\n    parameters = [\n        \"cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name\",\n        \"getSystemAttrsLDAP:action_result.status\",\n        \"getSystemAttrsLDAP:action_result.data.*.dnshostname\",\n        \"getSystemAttrsLDAP:action_result.data.*.operatingsystem\",\n        \"getSystemAttrsLDAP:action_result.data.*.operatingsystemservicepack\",\n        \"getSystemAttrsLDAP:action_result.data.*.operatingsystemversion\",\n    ]\n\n    phantom.format(container=container, template=template, parameters=parameters, name=\"formatGeneralNote\")\n\n    add_note_2(container=container)\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "getSystemAttrsLDAP",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "formatGeneralNote",
                        "description": "format findings for the LDAP systemInfo lookup ready to add to general notes. ",
                        "format": "format",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "1f698010-48b0-4d5c-a81b-ebc9e4556870",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 455,
                        "line_start": 427,
                        "message": "Configuring now",
                        "name": "format",
                        "notes": "format findings for the LDAP systemInfo lookup ready to add to general notes. ",
                        "number": 1,
                        "order": 15,
                        "outPorts": [
                            "out-1"
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "getSystemAttrsLDAP:action_result.status"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "getSystemAttrsLDAP:action_result.data.*.dnshostname"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "getSystemAttrsLDAP:action_result.data.*.operatingsystem"
                            },
                            {
                                "position": 4,
                                "type": "",
                                "value": "getSystemAttrsLDAP:action_result.data.*.operatingsystemservicepack"
                            },
                            {
                                "position": 5,
                                "type": "",
                                "value": "getSystemAttrsLDAP:action_result.data.*.operatingsystemversion"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 740,
                            "y": 460
                        },
                        "previous_function": "",
                        "previous_name": "formatGeneralNote",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "format",
                        "status": "",
                        "template": "## {0} - Actions ##\n\n** LDAP Status: **\n{1}\n\n|DNS Hostname|Operating System|ServicePack|OS Version|\n|---|---|---|---|\n| {2} | {3} | {4} | {5} |",
                        "title": "format",
                        "type": "coa.Format",
                        "warn": false,
                        "z": 51
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "2f87713d-5ab6-4950-bdc5-a9745c0d0c83",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "1f698010-48b0-4d5c-a81b-ebc9e4556870",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "af690d40-a5b0-4f82-8ffb-e7b33ce2bae5",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 53
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "a152d6a2-f43a-407a-9a03-9a4f47bbd875",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "af690d40-a5b0-4f82-8ffb-e7b33ce2bae5",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "683991ff-fb7e-42c4-a1d8-b9a75238da7a",
                            "selector": ".port-body[type=\"input\"]"
                        },
                        "type": "link",
                        "z": 55
                    },
                    {
                        "action": "update task",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "container_id": "container:id",
                            "note": "formatGeneralNote:formatted_data",
                            "note_title": "cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name",
                            "phase_name": "",
                            "role_id": "",
                            "status": "complete",
                            "task_id": "cf_local_POV_get_current_task_1:custom_function_result.data.task_id",
                            "task_name": "",
                            "user": "cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner"
                        },
                        "angle": 0,
                        "app": "Phantom",
                        "appid": "deb82aa9-22cc-4675-9cf1-534b8d006eb7",
                        "approver": "",
                        "assets": [
                            {
                                "action": "update task",
                                "actions": [
                                    "no op",
                                    "set current phase",
                                    "update task",
                                    "modify indicator tag",
                                    "get indicator",
                                    "update list",
                                    "get action result",
                                    "create container",
                                    "import container",
                                    "export container",
                                    "deflate item",
                                    "add artifact",
                                    "find listitem",
                                    "add listitem",
                                    "find artifacts",
                                    "update artifact tags",
                                    "add note",
                                    "update artifact",
                                    "update artifact fields",
                                    "tabulate data",
                                    "get user",
                                    "list playbooks",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Phantom",
                                "app_version": "2.1.29",
                                "appid": "deb82aa9-22cc-4675-9cf1-534b8d006eb7",
                                "asset_name": "phantomapp",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "container_id": "container:id",
                                    "note": "formatGeneralNote:formatted_data",
                                    "note_title": "cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name",
                                    "phase_name": "",
                                    "role_id": "",
                                    "status": "complete",
                                    "task_id": "cf_local_POV_get_current_task_1:custom_function_result.data.task_id",
                                    "task_name": "",
                                    "user": "cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner"
                                },
                                "has_app": true,
                                "id": 26,
                                "loaded": false,
                                "missing": false,
                                "name": "phantomapp",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.container_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.note",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.note_title",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.phase_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.role_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.task_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.task_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.user",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "container_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Container ID (current container if blank)",
                                        "key": "container_id",
                                        "order": 0,
                                        "primary": false,
                                        "required": false
                                    },
                                    "note": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task note",
                                        "key": "note",
                                        "order": 6,
                                        "primary": false,
                                        "required": false
                                    },
                                    "note_title": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Note title",
                                        "key": "note_title",
                                        "order": 7,
                                        "primary": false,
                                        "required": false
                                    },
                                    "phase_name": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Phase name",
                                        "key": "phase_name",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    },
                                    "role_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Task assignee (role)",
                                        "key": "role_id",
                                        "order": 5,
                                        "primary": false,
                                        "required": false
                                    },
                                    "status": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task status",
                                        "key": "status",
                                        "order": 4,
                                        "primary": false,
                                        "required": false,
                                        "value_list": [
                                            "incomplete",
                                            "in progress",
                                            "complete"
                                        ]
                                    },
                                    "task_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Task ID",
                                        "key": "task_id",
                                        "order": 1,
                                        "primary": false,
                                        "required": false
                                    },
                                    "task_name": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task name",
                                        "key": "task_name",
                                        "order": 3,
                                        "primary": false,
                                        "required": false
                                    },
                                    "user": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task assignee (username or user id)",
                                        "key": "user",
                                        "order": 4,
                                        "primary": true,
                                        "required": false
                                    }
                                },
                                "product_name": "Phantom",
                                "product_vendor": "Phantom",
                                "targets": "26",
                                "type": "information"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "TaskComplete"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def TaskComplete(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('TaskComplete() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    id_value = container.get('id', None)\n\n    # collect data for 'TaskComplete' call\n    custom_function_results_data_1 = phantom.collect2(container=container, datapath=['cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner'], action_results=results)\n    custom_function_results_data_2 = phantom.collect2(container=container, datapath=['cf_local_POV_get_current_task_1:custom_function_result.data.task_id', 'cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name'], action_results=results)\n    formatted_data_1 = phantom.get_format_data(name='formatGeneralNote')\n\n    parameters = []\n    \n    # build parameters list for 'TaskComplete' call\n    for custom_function_results_item_1 in custom_function_results_data_1:\n        for custom_function_results_item_2 in custom_function_results_data_2:\n            parameters.append({\n                'note': formatted_data_1,\n                'user': custom_function_results_item_1[0],\n                'status': \"complete\",\n                'role_id': \"\",\n                'task_id': custom_function_results_item_2[0],\n                'task_name': \"\",\n                'note_title': custom_function_results_item_2[1],\n                'phase_name': \"\",\n                'container_id': id_value,\n            })\n\n    phantom.act(action=\"update task\", parameters=parameters, assets=['phantomapp'], name=\"TaskComplete\")\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "getSystemAttrsLDAP",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "TaskComplete",
                        "delay": 0,
                        "description": "Update task notes and task status to complete. ",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "683991ff-fb7e-42c4-a1d8-b9a75238da7a",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 504,
                        "line_start": 471,
                        "message": "Configuring now",
                        "name": "update task",
                        "notes": "Update task notes and task status to complete. ",
                        "number": 5,
                        "order": 17,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1180,
                            "y": 460
                        },
                        "previous_function": "",
                        "previous_name": "TaskComplete",
                        "required_params": {},
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 56
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".functionBlock": {
                                "text": "formatCefString"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "custom function"
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn_grey.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def formatCefString(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('formatCefString() called')\n    \n    results_data_1 = phantom.collect2(container=container, datapath=['getSystemAttrsLDAP:action_result.data.*.operatingsystem', 'getSystemAttrsLDAP:action_result.data.*.operatingsystemservicepack', 'getSystemAttrsLDAP:action_result.data.*.operatingsystemversion', 'getSystemAttrsLDAP:action_result.data.*.dnshostname'], action_results=results)\n    results_item_1_0 = [item[0] for item in results_data_1]\n    results_item_1_1 = [item[1] for item in results_data_1]\n    results_item_1_2 = [item[2] for item in results_data_1]\n    results_item_1_3 = [item[3] for item in results_data_1]\n\n    formatCefString__cef_string = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n    \n    status = None\n    message = None\n    cef_string = None\n    \n    try:\n        cef_string = \"{\\\"cef\\\":{\"\n        #cef_string = '{'\n        if str(results_item_1_3[0]) != \"None\":\n               #cef_string[\"dnshostname\"] = results_item_1_3[0]\n            cef_string = cef_string + '\\\"dnshostname\\\":\\\"' + results_item_1_3[0] + '\\\"'\n                          \n        if str(results_item_1_0[0]) != \"None\":\n               #cef_string[\"operatingsystem\"] = results_item_1_0[0]\n            cef_string = cef_string + ',\\\"operatingsystem\\\":\\\"' + results_item_1_0[0] + '\\\"'\n        \n        if str(results_item_1_2[0]) != \"None\":\n               #cef_string[\"operatingsystemversion\"] = results_item_1_2[0]\n            cef_string = cef_string + ',\\\"operatingsystemversion\\\":\\\"' + results_item_1_2[0] + '\\\"'\n                          \n        if str(results_item_1_1[0]) != \"None\":\n               #cef_string[\"operatingsystemservicepack\"] = results_item_1_1[0]\n            cef_string = cef_string + ',\\\"operatingsystemservicepack\\\":\\\"' + results_item_1_1[0] + '\\\"'\n            \n        cef_string = cef_string + '}}'\n\n        phantom.debug('cef_stirng: {}'.format(cef_string))\n        status = 'success'\n\n    except Exception as e:\n        phantom.error('Failed Creating cef string: {}'.format(e))\n        status = 'failed'\n        message = e\n    \n    formatCefString__cef_string = cef_string\n    \n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='formatCefString:cef_string', value=json.dumps(formatCefString__cef_string))\n    updateArtifactLDAP(container=container)\n\n    return",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "getSystemAttrsLDAP",
                        "connection_type": "action",
                        "customCodeEndLineOffset": 7,
                        "customCodeStartLine": 14,
                        "custom_callback": "",
                        "custom_code": "def formatCefString(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None):\n    phantom.debug('custom_function_1() called')\n    results_data_1 = phantom.collect2(container=container, datapath=['get_system_attributes_1:action_result.data.*.operatingsystem', 'get_system_attributes_1:action_result.data.*.operatingsystemservicepack', 'get_system_attributes_1:action_result.data.*.operatingsystemversion', 'get_system_attributes_1:action_result.data.*.dnshostname'], action_results=results)\n    results_item_1_0 = [item[0] for item in results_data_1]\n    results_item_1_1 = [item[1] for item in results_data_1]\n    results_item_1_2 = [item[2] for item in results_data_1]\n    results_item_1_3 = [item[3] for item in results_data_1]\n\n    formatCefString__cef_string = None\n\n    ################################################################################\n    ## Custom Code Start\n    ################################################################################\n\n    # Write your custom code here...\n    \n    status = None\n    message = None\n    cef_string = None\n    \n    try:\n        cef_string = \"{\\\"cef\\\":{\"\n        #cef_string = '{'\n        if str(results_item_1_3[0]) != \"None\":\n               #cef_string[\"dnshostname\"] = results_item_1_3[0]\n            cef_string = cef_string + '\\\"dnshostname\\\":\\\"' + results_item_1_3[0] + '\\\"'\n                          \n        if str(results_item_1_0[0]) != \"None\":\n               #cef_string[\"operatingsystem\"] = results_item_1_0[0]\n            cef_string = cef_string + ',\\\"operatingsystem\\\":\\\"' + results_item_1_0[0] + '\\\"'\n        \n        if str(results_item_1_2[0]) != \"None\":\n               #cef_string[\"operatingsystemversion\"] = results_item_1_2[0]\n            cef_string = cef_string + ',\\\"operatingsystemversion\\\":\\\"' + results_item_1_2[0] + '\\\"'\n                          \n        if str(results_item_1_1[0]) != \"None\":\n               #cef_string[\"operatingsystemservicepack\"] = results_item_1_1[0]\n            cef_string = cef_string + ',\\\"operatingsystemservicepack\\\":\\\"' + results_item_1_1[0] + '\\\"'\n            \n        cef_string = cef_string + '}}'\n\n        phantom.debug('cef_stirng: {}'.format(cef_string))\n        status = 'success'\n\n    except Exception as e:\n        phantom.error('Failed Creating cef string: {}'.format(e))\n        status = 'failed'\n        message = e\n    \n    formatCefString__cef_string = cef_string\n    \n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ################################################################################\n    ## Custom Code End\n    ################################################################################\n\n    phantom.save_run_data(key='custom_function_1:cef_string', value=json.dumps(formatCefString__cef_string))\n    update_artifact_fields_1(container=container)\n\n    return",
                        "custom_join": "",
                        "custom_name": "formatCefString",
                        "description": "Formats the output of system attributes into a cef string ready to add the data to the artifact",
                        "functionBlock": "custom function",
                        "has_custom": true,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "96d885c4-bbfb-42ca-84ff-4b96958ddd8c",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "legacy": true,
                        "line_end": 395,
                        "line_start": 312,
                        "message": "Configuring now",
                        "name": "custom function",
                        "notes": "Formats the output of system attributes into a cef string ready to add the data to the artifact",
                        "number": 1,
                        "order": 13,
                        "outPorts": [
                            "out"
                        ],
                        "outputVariables": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "cef_string"
                            }
                        ],
                        "parameters": [
                            {
                                "position": 0,
                                "type": "",
                                "value": "getSystemAttrsLDAP:action_result.data.*.operatingsystem"
                            },
                            {
                                "position": 1,
                                "type": "",
                                "value": "getSystemAttrsLDAP:action_result.data.*.operatingsystemservicepack"
                            },
                            {
                                "position": 2,
                                "type": "",
                                "value": "getSystemAttrsLDAP:action_result.data.*.operatingsystemversion"
                            },
                            {
                                "position": 3,
                                "type": "",
                                "value": "getSystemAttrsLDAP:action_result.data.*.dnshostname"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 740,
                            "y": 580
                        },
                        "previous_function": "",
                        "previous_name": "formatCefString",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "custom function",
                        "status": "deprecating",
                        "title": "custom function",
                        "type": "coa.FunctionBlock",
                        "userGeneratedCode": "\n    # Write your custom code here...\n    \n    status = None\n    message = None\n    cef_string = None\n    \n    try:\n        cef_string = \"{\\\"cef\\\":{\"\n        #cef_string = '{'\n        if str(results_item_1_3[0]) != \"None\":\n               #cef_string[\"dnshostname\"] = results_item_1_3[0]\n            cef_string = cef_string + '\\\"dnshostname\\\":\\\"' + results_item_1_3[0] + '\\\"'\n                          \n        if str(results_item_1_0[0]) != \"None\":\n               #cef_string[\"operatingsystem\"] = results_item_1_0[0]\n            cef_string = cef_string + ',\\\"operatingsystem\\\":\\\"' + results_item_1_0[0] + '\\\"'\n        \n        if str(results_item_1_2[0]) != \"None\":\n               #cef_string[\"operatingsystemversion\"] = results_item_1_2[0]\n            cef_string = cef_string + ',\\\"operatingsystemversion\\\":\\\"' + results_item_1_2[0] + '\\\"'\n                          \n        if str(results_item_1_1[0]) != \"None\":\n               #cef_string[\"operatingsystemservicepack\"] = results_item_1_1[0]\n            cef_string = cef_string + ',\\\"operatingsystemservicepack\\\":\\\"' + results_item_1_1[0] + '\\\"'\n            \n        cef_string = cef_string + '}}'\n\n        phantom.debug('cef_stirng: {}'.format(cef_string))\n        status = 'success'\n\n    except Exception as e:\n        phantom.error('Failed Creating cef string: {}'.format(e))\n        status = 'failed'\n        message = e\n    \n    formatCefString__cef_string = cef_string\n    \n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n    ###############################\n",
                        "warn": false,
                        "z": 57
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "14aeb5d9-260c-4bf1-80fd-3ea9fe419dac",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "b99184a9-9c03-4deb-a2d2-a59f403a07e8",
                            "port": "out-1",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "c3a81485-1660-4172-a8fd-fccfffef253c",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 58
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add note",
                        "attrs": {
                            ".api": {
                                "text": "add note"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def add_note_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('add_note_2() called')\n\n    formatted_data_1 = phantom.get_format_data(name='formatGeneralNote')\n\n    note_title = \"LDAP System Info\"\n    note_content = formatted_data_1\n    note_format = \"markdown\"\n    phantom.add_note(container=container, note_type=\"general\", title=note_title, content=note_content, note_format=note_format)\n    TaskComplete(container=container)\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addNoteContent": "formatGeneralNote:formatted_data",
                                "addNoteNoteFormat": "markdown",
                                "addNoteTitle": "LDAP System Info",
                                "key": "add-note"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "getSystemAttrsLDAP",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "af690d40-a5b0-4f82-8ffb-e7b33ce2bae5",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 468,
                        "line_start": 455,
                        "message": "Configuring now",
                        "name": "add note",
                        "notes": "",
                        "number": 2,
                        "order": 16,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 960,
                            "y": 460
                        },
                        "previous_function": "",
                        "previous_name": "add_note_2",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 59
                    },
                    {
                        "action": "update task",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "container_id": "container:id",
                            "note": "Unable to find artifacts with destinationHostName field",
                            "note_title": "cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name",
                            "phase_name": "",
                            "role_id": "",
                            "status": "complete",
                            "task_id": "cf_local_POV_get_current_task_1:custom_function_result.data.task_id",
                            "task_name": "",
                            "user": "cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner"
                        },
                        "angle": 0,
                        "app": "Phantom",
                        "appid": "deb82aa9-22cc-4675-9cf1-534b8d006eb7",
                        "approver": "",
                        "assets": [
                            {
                                "action": "update task",
                                "actions": [
                                    "no op",
                                    "set current phase",
                                    "update task",
                                    "modify indicator tag",
                                    "get indicator",
                                    "update list",
                                    "get action result",
                                    "create container",
                                    "import container",
                                    "export container",
                                    "deflate item",
                                    "add artifact",
                                    "find listitem",
                                    "add listitem",
                                    "find artifacts",
                                    "update artifact tags",
                                    "add note",
                                    "update artifact",
                                    "update artifact fields",
                                    "tabulate data",
                                    "get user",
                                    "list playbooks",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Phantom",
                                "app_version": "2.1.29",
                                "appid": "deb82aa9-22cc-4675-9cf1-534b8d006eb7",
                                "asset_name": "phantomapp",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "container_id": "container:id",
                                    "note": "Unable to find artifacts with destinationHostName field",
                                    "note_title": "cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name",
                                    "phase_name": "",
                                    "role_id": "",
                                    "status": "complete",
                                    "task_id": "cf_local_POV_get_current_task_1:custom_function_result.data.task_id",
                                    "task_name": "",
                                    "user": "cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner"
                                },
                                "has_app": true,
                                "id": 26,
                                "loaded": false,
                                "missing": false,
                                "name": "phantomapp",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.container_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.note",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.note_title",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.phase_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.role_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.task_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.task_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.user",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "container_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Container ID (current container if blank)",
                                        "key": "container_id",
                                        "order": 0,
                                        "primary": false,
                                        "required": false
                                    },
                                    "note": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task note",
                                        "key": "note",
                                        "order": 6,
                                        "primary": false,
                                        "required": false
                                    },
                                    "note_title": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Note title",
                                        "key": "note_title",
                                        "order": 7,
                                        "primary": false,
                                        "required": false
                                    },
                                    "phase_name": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Phase name",
                                        "key": "phase_name",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    },
                                    "role_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Task assignee (role)",
                                        "key": "role_id",
                                        "order": 5,
                                        "primary": false,
                                        "required": false
                                    },
                                    "status": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task status",
                                        "key": "status",
                                        "order": 4,
                                        "primary": false,
                                        "required": false,
                                        "value_list": [
                                            "incomplete",
                                            "in progress",
                                            "complete"
                                        ]
                                    },
                                    "task_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Task ID",
                                        "key": "task_id",
                                        "order": 1,
                                        "primary": false,
                                        "required": false
                                    },
                                    "task_name": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task name",
                                        "key": "task_name",
                                        "order": 3,
                                        "primary": false,
                                        "required": false
                                    },
                                    "user": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task assignee (username or user id)",
                                        "key": "user",
                                        "order": 4,
                                        "primary": true,
                                        "required": false
                                    }
                                },
                                "product_name": "Phantom",
                                "product_vendor": "Phantom",
                                "targets": "26",
                                "type": "information"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "CompleteTaskNoArtifacts"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def CompleteTaskNoArtifacts(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('CompleteTaskNoArtifacts() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    id_value = container.get('id', None)\n\n    # collect data for 'CompleteTaskNoArtifacts' call\n    custom_function_results_data_1 = phantom.collect2(container=container, datapath=['cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner'], action_results=results)\n    custom_function_results_data_2 = phantom.collect2(container=container, datapath=['cf_local_POV_get_current_task_1:custom_function_result.data.task_id', 'cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'CompleteTaskNoArtifacts' call\n    for custom_function_results_item_1 in custom_function_results_data_1:\n        for custom_function_results_item_2 in custom_function_results_data_2:\n            parameters.append({\n                'note': \"Unable to find artifacts with destinationHostName field\",\n                'user': custom_function_results_item_1[0],\n                'status': \"complete\",\n                'role_id': \"\",\n                'task_id': custom_function_results_item_2[0],\n                'task_name': \"\",\n                'note_title': custom_function_results_item_2[1],\n                'phase_name': \"\",\n                'container_id': id_value,\n            })\n\n    phantom.act(action=\"update task\", parameters=parameters, assets=['phantomapp'], name=\"CompleteTaskNoArtifacts\")\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "TaskInProgress",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "CompleteTaskNoArtifacts",
                        "delay": 0,
                        "description": "Completes the task and adds note. Requires artefacts to contain destinationHostName",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "cd287f6b-267a-4850-8c1d-3ed7023d941c",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 203,
                        "line_start": 171,
                        "message": "Configuring now",
                        "name": "update task",
                        "notes": "Completes the task and adds note. Requires artefacts to contain destinationHostName",
                        "number": 3,
                        "order": 8,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1180,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "CompleteTaskNoArtifacts",
                        "required_params": {},
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 61
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "api": "add comment",
                        "attrs": {
                            ".api": {
                                "text": "TaskIdentError"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "API"
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            }
                        },
                        "block_code": "def TaskIdentError(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('TaskIdentError() called')\n\n    phantom.comment(container=container, comment=\"Unable to determined current task. - Please check\")\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "color": "",
                        "configured": [
                            {
                                "addCommentComment": "Unable to determined current task. - Please check",
                                "key": "add-comment"
                            }
                        ],
                        "connected_to_start": true,
                        "connection_name": "POV_get_current_task",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "TaskIdentError",
                        "description": "Unable to determine the task id or current workbook phase.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "6a1c06e3-ca68-420b-bd74-2cf6075f6803",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 112,
                        "line_start": 105,
                        "message": "Configuring now",
                        "name": "add comment",
                        "notes": "Unable to determine the task id or current workbook phase.",
                        "number": 1,
                        "order": 5,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1180,
                            "y": 80
                        },
                        "previous_function": "",
                        "previous_name": "TaskIdentError",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "api",
                        "status": "",
                        "title": "API",
                        "type": "coa.API",
                        "warn": false,
                        "z": 62
                    },
                    {
                        "action": "update artifact fields",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "artifact_id": "artifact:*.id",
                            "data": "formatCefString:custom_function:cef_string",
                            "overwrite": ""
                        },
                        "angle": 0,
                        "app": "Phantom",
                        "appid": "deb82aa9-22cc-4675-9cf1-534b8d006eb7",
                        "approver": "",
                        "assets": [
                            {
                                "action": "update artifact fields",
                                "actions": [
                                    "no op",
                                    "set current phase",
                                    "update task",
                                    "modify indicator tag",
                                    "get indicator",
                                    "update list",
                                    "get action result",
                                    "create container",
                                    "import container",
                                    "export container",
                                    "deflate item",
                                    "add artifact",
                                    "find listitem",
                                    "add listitem",
                                    "find artifacts",
                                    "update artifact tags",
                                    "add note",
                                    "update artifact",
                                    "update artifact fields",
                                    "tabulate data",
                                    "get user",
                                    "list playbooks",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Phantom",
                                "app_version": "2.1.29",
                                "appid": "deb82aa9-22cc-4675-9cf1-534b8d006eb7",
                                "asset_name": "phantomapp",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "artifact_id": "artifact:*.id",
                                    "data": "formatCefString:custom_function:cef_string",
                                    "overwrite": ""
                                },
                                "has_app": true,
                                "id": 26,
                                "loaded": false,
                                "missing": false,
                                "name": "phantomapp",
                                "output": [
                                    {
                                        "column_name": "Status",
                                        "data_path": "action_result.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.artifact_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.overwrite",
                                        "data_type": "boolean"
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    }
                                ],
                                "parameters": {
                                    "artifact_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "artifact_id",
                                        "key": "artifact_id",
                                        "primary": true,
                                        "required": true
                                    },
                                    "data": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "update data (json formatted)",
                                        "key": "data",
                                        "required": true
                                    },
                                    "overwrite": {
                                        "data_type": "boolean",
                                        "default": null,
                                        "description": "overwrite existing",
                                        "key": "overwrite",
                                        "required": false
                                    }
                                },
                                "product_name": "Phantom",
                                "product_vendor": "Phantom",
                                "targets": "26",
                                "type": "information"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "updateArtifactLDAP"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def updateArtifactLDAP(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('updateArtifactLDAP() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    formatCefString__cef_string = json.loads(phantom.get_run_data(key='formatCefString:cef_string'))\n    # collect data for 'updateArtifactLDAP' call\n    container_data = phantom.collect2(container=container, datapath=['artifact:*.id', 'artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'updateArtifactLDAP' call\n    for container_item in container_data:\n        if container_item[0]:\n            parameters.append({\n                'data': formatCefString__cef_string,\n                'overwrite': \"\",\n                'artifact_id': container_item[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': container_item[1]},\n            })\n\n    phantom.act(action=\"update artifact fields\", parameters=parameters, assets=['phantomapp'], name=\"updateArtifactLDAP\")\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "getSystemAttrsLDAP",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "updateArtifactLDAP",
                        "delay": 0,
                        "description": "Add OS, Version, ServicePack & DNSHostName if it doesnt exist to the artifact",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "928bdd2d-de1e-429f-9ffa-0f782e4b0377",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 424,
                        "line_start": 398,
                        "message": "Configuring now",
                        "name": "update artifact fields",
                        "notes": "Add OS, Version, ServicePack & DNSHostName if it doesnt exist to the artifact",
                        "number": 1,
                        "order": 14,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 960,
                            "y": 580
                        },
                        "previous_function": "",
                        "previous_name": "updateArtifactLDAP",
                        "required_params": {
                            "artifact_id": true,
                            "data": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 63
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "bc34150b-a35d-457a-b9db-c4bfaf270916",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "683991ff-fb7e-42c4-a1d8-b9a75238da7a",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "29c6996e-3cb2-4a94-8ecc-bc5076151a5f",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 64
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "9b1c9b9c-1db6-496e-a35b-f2084a1e9ee1",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "6a1c06e3-ca68-420b-bd74-2cf6075f6803",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "29c6996e-3cb2-4a94-8ecc-bc5076151a5f",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 65
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "5c213229-8037-4b32-af2f-764748f5e87d",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "cd287f6b-267a-4850-8c1d-3ed7023d941c",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "29c6996e-3cb2-4a94-8ecc-bc5076151a5f",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 66
                    },
                    {
                        "attrs": {
                            ".connection": {
                                "stroke": "#818D99",
                                "stroke-width": 2
                            },
                            ".marker-target": {
                                "d": "M 10 0 L 0 5 L 10 10 z",
                                "fill": "#818D99",
                                "stroke": "#818D99"
                            }
                        },
                        "connector": {
                            "args": {
                                "radius": 5
                            },
                            "name": "rounded"
                        },
                        "endDirections": [
                            "left"
                        ],
                        "id": "0035b2b8-1619-4b3d-a88e-7cbd161bf3b5",
                        "router": {
                            "name": "metro"
                        },
                        "source": {
                            "id": "c3a81485-1660-4172-a8fd-fccfffef253c",
                            "selector": "> g:nth-child(1) > g:nth-child(2) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "startDirections": [
                            "right"
                        ],
                        "target": {
                            "id": "29c6996e-3cb2-4a94-8ecc-bc5076151a5f",
                            "selector": "> g:nth-child(1) > g:nth-child(1) > g:nth-child(1) > circle:nth-child(1)"
                        },
                        "type": "link",
                        "z": 67
                    },
                    {
                        "action": "update task",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "container_id": "container:id",
                            "note": "getSystemAttrsLDAP:action_result.message",
                            "note_title": "cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name",
                            "phase_name": "",
                            "role_id": "",
                            "status": "complete",
                            "task_id": "cf_local_POV_get_current_task_1:custom_function_result.data.task_id",
                            "task_name": "",
                            "user": "cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner"
                        },
                        "angle": 0,
                        "app": "Phantom",
                        "appid": "deb82aa9-22cc-4675-9cf1-534b8d006eb7",
                        "approver": "",
                        "assets": [
                            {
                                "action": "update task",
                                "actions": [
                                    "no op",
                                    "set current phase",
                                    "update task",
                                    "modify indicator tag",
                                    "get indicator",
                                    "update list",
                                    "get action result",
                                    "create container",
                                    "import container",
                                    "export container",
                                    "deflate item",
                                    "add artifact",
                                    "find listitem",
                                    "add listitem",
                                    "find artifacts",
                                    "update artifact tags",
                                    "add note",
                                    "update artifact",
                                    "update artifact fields",
                                    "tabulate data",
                                    "get user",
                                    "list playbooks",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Phantom",
                                "app_version": "2.1.29",
                                "appid": "deb82aa9-22cc-4675-9cf1-534b8d006eb7",
                                "asset_name": "phantomapp",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "container_id": "container:id",
                                    "note": "getSystemAttrsLDAP:action_result.message",
                                    "note_title": "cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name",
                                    "phase_name": "",
                                    "role_id": "",
                                    "status": "complete",
                                    "task_id": "cf_local_POV_get_current_task_1:custom_function_result.data.task_id",
                                    "task_name": "",
                                    "user": "cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner"
                                },
                                "has_app": true,
                                "id": 26,
                                "loaded": false,
                                "missing": false,
                                "name": "phantomapp",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.container_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.note",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.note_title",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.phase_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.role_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.task_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.task_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.user",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "container_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Container ID (current container if blank)",
                                        "key": "container_id",
                                        "order": 0,
                                        "primary": false,
                                        "required": false
                                    },
                                    "note": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task note",
                                        "key": "note",
                                        "order": 6,
                                        "primary": false,
                                        "required": false
                                    },
                                    "note_title": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Note title",
                                        "key": "note_title",
                                        "order": 7,
                                        "primary": false,
                                        "required": false
                                    },
                                    "phase_name": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Phase name",
                                        "key": "phase_name",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    },
                                    "role_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Task assignee (role)",
                                        "key": "role_id",
                                        "order": 5,
                                        "primary": false,
                                        "required": false
                                    },
                                    "status": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task status",
                                        "key": "status",
                                        "order": 4,
                                        "primary": false,
                                        "required": false,
                                        "value_list": [
                                            "incomplete",
                                            "in progress",
                                            "complete"
                                        ]
                                    },
                                    "task_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Task ID",
                                        "key": "task_id",
                                        "order": 1,
                                        "primary": false,
                                        "required": false
                                    },
                                    "task_name": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task name",
                                        "key": "task_name",
                                        "order": 3,
                                        "primary": false,
                                        "required": false
                                    },
                                    "user": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task assignee (username or user id)",
                                        "key": "user",
                                        "order": 4,
                                        "primary": true,
                                        "required": false
                                    }
                                },
                                "product_name": "Phantom",
                                "product_vendor": "Phantom",
                                "targets": "26",
                                "type": "information"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "CompleteTaskError"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def CompleteTaskError(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('CompleteTaskError() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    id_value = container.get('id', None)\n\n    # collect data for 'CompleteTaskError' call\n    results_data_1 = phantom.collect2(container=container, datapath=['getSystemAttrsLDAP:action_result.message', 'getSystemAttrsLDAP:action_result.parameter.context.artifact_id'], action_results=results)\n    custom_function_results_data_1 = phantom.collect2(container=container, datapath=['cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner'], action_results=results)\n    custom_function_results_data_2 = phantom.collect2(container=container, datapath=['cf_local_POV_get_current_task_1:custom_function_result.data.task_id', 'cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'CompleteTaskError' call\n    for results_item_1 in results_data_1:\n        for custom_function_results_item_1 in custom_function_results_data_1:\n            for custom_function_results_item_2 in custom_function_results_data_2:\n                parameters.append({\n                    'note': results_item_1[0],\n                    'user': custom_function_results_item_1[0],\n                    'status': \"complete\",\n                    'role_id': \"\",\n                    'task_id': custom_function_results_item_2[0],\n                    'task_name': \"\",\n                    'note_title': custom_function_results_item_2[1],\n                    'phase_name': \"\",\n                    'container_id': id_value,\n                    # context (artifact id) is added to associate results with the artifact\n                    'context': {'artifact_id': results_item_1[1]},\n                })\n\n    phantom.act(action=\"update task\", parameters=parameters, assets=['phantomapp'], name=\"CompleteTaskError\")\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "getSystemAttrsLDAP",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "CompleteTaskError",
                        "delay": 0,
                        "description": "Updates the task to complete and includes the error message received from LDAP",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "c3a81485-1660-4172-a8fd-fccfffef253c",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 309,
                        "line_start": 273,
                        "message": "Configuring now",
                        "name": "update task",
                        "notes": "Updates the task to complete and includes the error message received from LDAP",
                        "number": 4,
                        "order": 12,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 1180,
                            "y": 340
                        },
                        "previous_function": "",
                        "previous_name": "CompleteTaskError",
                        "required_params": {},
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 68
                    },
                    {
                        "action": "update task",
                        "action_type": "generic",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "container_id": "container:id",
                            "note": "Task Started",
                            "note_title": "cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name",
                            "phase_name": "",
                            "role_id": "",
                            "status": "in progress",
                            "task_id": "cf_local_POV_get_current_task_1:custom_function_result.data.task_id",
                            "task_name": "",
                            "user": "cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner"
                        },
                        "angle": 0,
                        "app": "Phantom",
                        "appid": "deb82aa9-22cc-4675-9cf1-534b8d006eb7",
                        "approver": "",
                        "assets": [
                            {
                                "action": "update task",
                                "actions": [
                                    "no op",
                                    "set current phase",
                                    "update task",
                                    "modify indicator tag",
                                    "get indicator",
                                    "update list",
                                    "get action result",
                                    "create container",
                                    "import container",
                                    "export container",
                                    "deflate item",
                                    "add artifact",
                                    "find listitem",
                                    "add listitem",
                                    "find artifacts",
                                    "update artifact tags",
                                    "add note",
                                    "update artifact",
                                    "update artifact fields",
                                    "tabulate data",
                                    "get user",
                                    "list playbooks",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "Phantom",
                                "app_version": "2.1.29",
                                "appid": "deb82aa9-22cc-4675-9cf1-534b8d006eb7",
                                "asset_name": "phantomapp",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "container_id": "container:id",
                                    "note": "Task Started",
                                    "note_title": "cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name",
                                    "phase_name": "",
                                    "role_id": "",
                                    "status": "in progress",
                                    "task_id": "cf_local_POV_get_current_task_1:custom_function_result.data.task_id",
                                    "task_name": "",
                                    "user": "cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner"
                                },
                                "has_app": true,
                                "id": 26,
                                "loaded": false,
                                "missing": false,
                                "name": "phantomapp",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.container_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.note",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.note_title",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.phase_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.role_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.status",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.task_id",
                                        "data_type": "numeric"
                                    },
                                    {
                                        "data_path": "action_result.parameter.task_name",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.parameter.user",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Message",
                                        "column_order": 0,
                                        "data_path": "action_result.message",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "container_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Container ID (current container if blank)",
                                        "key": "container_id",
                                        "order": 0,
                                        "primary": false,
                                        "required": false
                                    },
                                    "note": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task note",
                                        "key": "note",
                                        "order": 6,
                                        "primary": false,
                                        "required": false
                                    },
                                    "note_title": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Note title",
                                        "key": "note_title",
                                        "order": 7,
                                        "primary": false,
                                        "required": false
                                    },
                                    "phase_name": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Phase name",
                                        "key": "phase_name",
                                        "order": 2,
                                        "primary": false,
                                        "required": false
                                    },
                                    "role_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Task assignee (role)",
                                        "key": "role_id",
                                        "order": 5,
                                        "primary": false,
                                        "required": false
                                    },
                                    "status": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task status",
                                        "key": "status",
                                        "order": 4,
                                        "primary": false,
                                        "required": false,
                                        "value_list": [
                                            "incomplete",
                                            "in progress",
                                            "complete"
                                        ]
                                    },
                                    "task_id": {
                                        "data_type": "numeric",
                                        "default": null,
                                        "description": "Task ID",
                                        "key": "task_id",
                                        "order": 1,
                                        "primary": false,
                                        "required": false
                                    },
                                    "task_name": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task name",
                                        "key": "task_name",
                                        "order": 3,
                                        "primary": false,
                                        "required": false
                                    },
                                    "user": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Task assignee (username or user id)",
                                        "key": "user",
                                        "order": 4,
                                        "primary": true,
                                        "required": false
                                    }
                                },
                                "product_name": "Phantom",
                                "product_vendor": "Phantom",
                                "targets": "26",
                                "type": "information"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "TaskInProgress"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Generic"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_generic.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def TaskInProgress(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('TaskInProgress() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    id_value = container.get('id', None)\n\n    # collect data for 'TaskInProgress' call\n    custom_function_results_data_1 = phantom.collect2(container=container, datapath=['cf_local_POV_set_event_owner_to_current_1:custom_function_result.data.currentOwner'], action_results=results)\n    custom_function_results_data_2 = phantom.collect2(container=container, datapath=['cf_local_POV_get_current_task_1:custom_function_result.data.task_id', 'cf_local_POV_get_current_task_1:custom_function_result.data.current_playbook_name'], action_results=results)\n\n    parameters = []\n    \n    # build parameters list for 'TaskInProgress' call\n    for custom_function_results_item_1 in custom_function_results_data_1:\n        for custom_function_results_item_2 in custom_function_results_data_2:\n            parameters.append({\n                'note': \"Task Started\",\n                'user': custom_function_results_item_1[0],\n                'status': \"in progress\",\n                'role_id': \"\",\n                'task_id': custom_function_results_item_2[0],\n                'task_name': \"\",\n                'note_title': custom_function_results_item_2[1],\n                'phase_name': \"\",\n                'container_id': id_value,\n            })\n\n    phantom.act(action=\"update task\", parameters=parameters, assets=['phantomapp'], callback=decision_2, name=\"TaskInProgress\")\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "POV_get_current_task",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "TaskInProgress",
                        "delay": 0,
                        "description": "Sets the status of the task to InProgress.",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "4a84b156-761d-4097-b824-608905ca5b03",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 147,
                        "line_start": 115,
                        "message": "Configuring now",
                        "name": "update task",
                        "notes": "Sets the status of the task to InProgress.",
                        "number": 2,
                        "order": 6,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 40,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "TaskInProgress",
                        "required_params": {},
                        "reviewer": "",
                        "show_number": true,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Generic",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 69
                    },
                    {
                        "action": "get system attributes",
                        "action_type": "investigate",
                        "active": false,
                        "active_keys": {},
                        "active_values": {
                            "fields": "",
                            "hostname": "filtered-data:filter_1:condition_1:artifact:*.cef.destinationHostName"
                        },
                        "angle": 0,
                        "app": "LDAP",
                        "appid": "84110F27-6602-4DC8-A6F2-0311B1720BF8",
                        "approver": "",
                        "assets": [
                            {
                                "action": "get system attributes",
                                "actions": [
                                    "get users",
                                    "reset password",
                                    "set password",
                                    "get system attributes",
                                    "get user attributes",
                                    "set system attribute",
                                    "change system ou",
                                    "list user groups",
                                    "enable user",
                                    "disable user",
                                    "test connectivity"
                                ],
                                "active": true,
                                "app_name": "LDAP",
                                "app_version": "1.2.47",
                                "appid": "84110F27-6602-4DC8-A6F2-0311B1720BF8",
                                "asset_name": "domainctrl1",
                                "config_type": "asset",
                                "count": 0,
                                "fields": {
                                    "fields": "",
                                    "hostname": "filtered-data:filter_1:condition_1:artifact:*.cef.destinationHostName"
                                },
                                "has_app": true,
                                "id": 14,
                                "loaded": false,
                                "missing": false,
                                "name": "domainctrl1",
                                "output": [
                                    {
                                        "data_path": "action_result.status",
                                        "data_type": "string",
                                        "example_values": [
                                            "success",
                                            "failed"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.parameter.fields",
                                        "data_type": "string",
                                        "example_values": [
                                            "samaccountname,displayname",
                                            "all"
                                        ]
                                    },
                                    {
                                        "contains": [
                                            "host name",
                                            "ldap distinguished name"
                                        ],
                                        "data_path": "action_result.parameter.hostname",
                                        "data_type": "string",
                                        "example_values": [
                                            "test_hostname1"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.accountexpires",
                                        "data_type": "string",
                                        "example_values": [
                                            "9223370036854775807"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.badpasswordtime",
                                        "data_type": "string",
                                        "example_values": [
                                            "0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.badpwdcount",
                                        "data_type": "string",
                                        "example_values": [
                                            "0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.cn",
                                        "data_type": "string",
                                        "example_values": [
                                            "test_hostname"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.codepage",
                                        "data_type": "string",
                                        "example_values": [
                                            "0"
                                        ]
                                    },
                                    {
                                        "column_name": "Country Code",
                                        "column_order": 6,
                                        "data_path": "action_result.data.*.countrycode",
                                        "data_type": "string",
                                        "example_values": [
                                            "0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.displayname",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Distinguished Name",
                                        "column_order": 2,
                                        "contains": [
                                            "ldap distinguished name"
                                        ],
                                        "data_path": "action_result.data.*.distinguishedname",
                                        "data_type": "string",
                                        "example_values": [
                                            "CN=testhostname,OU=Test123,OU=ShawOU,DC=corp,DC=contoso,DC=com"
                                        ]
                                    },
                                    {
                                        "column_name": "DNS Hostname",
                                        "column_order": 1,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.dnshostname",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.dscorepropagationdata",
                                        "data_type": "string",
                                        "example_values": [
                                            "20181000074916.0Z;16010100000000.0Z"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.instancetype",
                                        "data_type": "string",
                                        "example_values": [
                                            "4"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.iscriticalsystemobject",
                                        "data_type": "string",
                                        "example_values": [
                                            "FALSE"
                                        ]
                                    },
                                    {
                                        "column_name": "Last Logoff",
                                        "column_order": 7,
                                        "data_path": "action_result.data.*.lastlogoff",
                                        "data_type": "string",
                                        "example_values": [
                                            "0"
                                        ]
                                    },
                                    {
                                        "column_name": "Last Logon",
                                        "column_order": 8,
                                        "data_path": "action_result.data.*.lastlogon",
                                        "data_type": "string",
                                        "example_values": [
                                            "0"
                                        ]
                                    },
                                    {
                                        "column_name": "Last Logon Timestamp",
                                        "column_order": 9,
                                        "data_path": "action_result.data.*.lastlogontimestamp",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Local Policy Flags",
                                        "column_order": 10,
                                        "data_path": "action_result.data.*.localpolicyflags",
                                        "data_type": "string",
                                        "example_values": [
                                            "0"
                                        ]
                                    },
                                    {
                                        "column_name": "Logon Count",
                                        "column_order": 11,
                                        "data_path": "action_result.data.*.logoncount",
                                        "data_type": "string",
                                        "example_values": [
                                            "0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.ms-ds-creatorsid",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Host Name",
                                        "column_order": 0,
                                        "contains": [
                                            "host name"
                                        ],
                                        "data_path": "action_result.data.*.name",
                                        "data_type": "string",
                                        "example_values": [
                                            "test_hostname"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.netbootguid",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.netbootmirrordatafile",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Object Category",
                                        "column_order": 3,
                                        "data_path": "action_result.data.*.objectcategory",
                                        "data_type": "string",
                                        "example_values": [
                                            "CN=Computer,CN=Schema,CN=Configuration,DC=corp,DC=contoso,DC=com"
                                        ]
                                    },
                                    {
                                        "column_name": "Object Class",
                                        "column_order": 4,
                                        "data_path": "action_result.data.*.objectclass",
                                        "data_type": "string",
                                        "example_values": [
                                            "top;person;organizationalPerson;user;computer"
                                        ]
                                    },
                                    {
                                        "column_name": "Object GUID",
                                        "column_order": 5,
                                        "data_path": "action_result.data.*.objectguid",
                                        "data_type": "string",
                                        "example_values": [
                                            "76 40 ab 86 69 e7 d9 48 95 67 3f 3b a5 1c 73 6b"
                                        ]
                                    },
                                    {
                                        "column_name": "Object SID",
                                        "column_order": 12,
                                        "data_path": "action_result.data.*.objectsid",
                                        "data_type": "string",
                                        "example_values": [
                                            "01 00 00 00 00 00 00 05 15 00 00 00 68 1d ef e1 d1 b7 2c 16 11 a2 7a 93 84 2f 00 00"
                                        ]
                                    },
                                    {
                                        "column_name": "OS",
                                        "column_order": 13,
                                        "data_path": "action_result.data.*.operatingsystem",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Service Pack",
                                        "column_order": 14,
                                        "data_path": "action_result.data.*.operatingsystemservicepack",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "OS Version",
                                        "column_order": 15,
                                        "data_path": "action_result.data.*.operatingsystemversion",
                                        "data_type": "string"
                                    },
                                    {
                                        "column_name": "Primary Group ID",
                                        "column_order": 16,
                                        "data_path": "action_result.data.*.primarygroupid",
                                        "data_type": "string",
                                        "example_values": [
                                            "515"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.pwdlastset",
                                        "data_type": "string",
                                        "example_values": [
                                            "131846800401723900"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.samaccountname",
                                        "data_type": "string",
                                        "example_values": [
                                            "test_hostname1"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.samaccounttype",
                                        "data_type": "string",
                                        "example_values": [
                                            "805006369"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.serviceprincipalname",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.data.*.useraccountcontrol",
                                        "data_type": "string",
                                        "example_values": [
                                            "4100"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.usnchanged",
                                        "data_type": "string",
                                        "example_values": [
                                            "1691800"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.usncreated",
                                        "data_type": "string",
                                        "example_values": [
                                            "1689700"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.whenchanged",
                                        "data_type": "string",
                                        "example_values": [
                                            "20181023125053.0Z"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.data.*.whencreated",
                                        "data_type": "string",
                                        "example_values": [
                                            "20181022122540.0Z"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.bad_password_count",
                                        "data_type": "string",
                                        "example_values": [
                                            "0"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.last_logon",
                                        "data_type": "string",
                                        "example_values": [
                                            "Never"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.os",
                                        "data_type": "string"
                                    },
                                    {
                                        "data_path": "action_result.summary.password_last_set",
                                        "data_type": "string",
                                        "example_values": [
                                            "10/01/2018 12:25:40 PM UTC"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.summary.state",
                                        "data_type": "string",
                                        "example_values": [
                                            "Enabled"
                                        ]
                                    },
                                    {
                                        "data_path": "action_result.message",
                                        "data_type": "string",
                                        "example_values": [
                                            "State: Enabled, Bad password count: 0, Last logon: Never, Password last set: 10/22/2018 12:25:40 PM UTC"
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    },
                                    {
                                        "data_path": "summary.total_objects_successful",
                                        "data_type": "numeric",
                                        "example_values": [
                                            1
                                        ]
                                    }
                                ],
                                "parameters": {
                                    "fields": {
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Get fields (comma-separated)",
                                        "key": "fields",
                                        "order": 1,
                                        "required": false
                                    },
                                    "hostname": {
                                        "contains": [
                                            "host name",
                                            "ldap distinguished name"
                                        ],
                                        "data_type": "string",
                                        "default": null,
                                        "description": "Hostname to query the attributes of",
                                        "key": "hostname",
                                        "order": 0,
                                        "primary": true,
                                        "required": true
                                    }
                                },
                                "product_name": "Windows Server",
                                "product_vendor": "Microsoft",
                                "targets": "14",
                                "type": "directory service"
                            }
                        ],
                        "attrs": {
                            ".action": {
                                "text": "getSystemAttrsLDAP"
                            },
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#E6984E"
                            },
                            ".color-band": {
                                "fill": "#3C444D"
                            },
                            ".inPorts>.port-in": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".inPorts>.port-in>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".message": {
                                "opacity": 0,
                                "ref-x": 5,
                                "ref-y": 105,
                                "text": "Configuring now"
                            },
                            ".outPorts>.port-out": {
                                "ref": ".background",
                                "ref-x": 0.5
                            },
                            ".outPorts>.port-out>.port-body": {
                                "port": {
                                    "id": "out",
                                    "type": "out"
                                }
                            },
                            ".title": {
                                "text": "Investigate"
                            },
                            "g.approver image": {
                                "opacity": 1
                            },
                            "g.code image": {
                                "opacity": 1
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 1
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.icon image": {
                                "xlink:href": "/inc/coa/img/block_icon_investigate.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1,
                                "xlink:href": "/inc/coa/img/block_icon_note_dark_on.svg"
                            },
                            "g.timer image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def getSystemAttrsLDAP(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('getSystemAttrsLDAP() called')\n        \n    #phantom.debug('Action: {0} {1}'.format(action['name'], ('SUCCEEDED' if success else 'FAILED')))\n    \n    # collect data for 'getSystemAttrsLDAP' call\n    filtered_artifacts_data_1 = phantom.collect2(container=container, datapath=['filtered-data:filter_1:condition_1:artifact:*.cef.destinationHostName', 'filtered-data:filter_1:condition_1:artifact:*.id'])\n\n    parameters = []\n    \n    # build parameters list for 'getSystemAttrsLDAP' call\n    for filtered_artifacts_item_1 in filtered_artifacts_data_1:\n        if filtered_artifacts_item_1[0]:\n            parameters.append({\n                'fields': \"\",\n                'hostname': filtered_artifacts_item_1[0],\n                # context (artifact id) is added to associate results with the artifact\n                'context': {'artifact_id': filtered_artifacts_item_1[1]},\n            })\n\n    phantom.act(action=\"get system attributes\", parameters=parameters, assets=['domainctrl1'], callback=decision_3, name=\"getSystemAttrsLDAP\")\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": true,
                        "color": "",
                        "connected_to_start": true,
                        "connection_name": "TaskInProgress",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "getSystemAttrsLDAP",
                        "delay": 0,
                        "description": "Use LDAP to lookup any known system attributes of the host itself. (ServicePack, OS, SystemVersion, DNS Hostname)",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "3554520c-a0eb-4b51-90eb-53c5b399dd8b",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 248,
                        "line_start": 224,
                        "message": "Configuring now",
                        "name": "get system attributes",
                        "notes": "Use LDAP to lookup any known system attributes of the host itself. (ServicePack, OS, SystemVersion, DNS Hostname)",
                        "number": 1,
                        "order": 10,
                        "outPorts": [
                            "out"
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 440,
                            "y": 340
                        },
                        "previous_function": "",
                        "previous_name": "getSystemAttrsLDAP",
                        "required_params": {
                            "hostname": true
                        },
                        "reviewer": "",
                        "show_number": false,
                        "size": {
                            "height": 100,
                            "width": 180
                        },
                        "state": "app_action_assets",
                        "status": "warn",
                        "title": "Investigate",
                        "type": "coa.Action",
                        "warn": false,
                        "z": 70
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#5C6773",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 1
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def filter_1(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('filter_1() called')\n\n    # collect filtered artifact ids for 'if' condition 1\n    matched_artifacts_1, matched_results_1 = phantom.condition(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact:*.cef.destinationHostName\", \"!=\", \"\"],\n        ],\n        name=\"filter_1:condition_1\")\n\n    # call connected blocks if filtered artifacts or results\n    if matched_artifacts_1 or matched_results_1:\n        getSystemAttrsLDAP(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function, filtered_artifacts=matched_artifacts_1, filtered_results=matched_results_1)\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "TaskInProgress",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "44f8a0bd-16c5-4c93-ac0b-1c5dd5b7d4d3",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 221,
                        "line_start": 203,
                        "name": "filter",
                        "notes": "",
                        "number": 1,
                        "order": 9,
                        "outPorts": [
                            "out-1"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "!=",
                                        "data_type": "",
                                        "param": "artifact:*.cef.destinationHostName",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 320,
                            "y": 340
                        },
                        "previous_function": "",
                        "previous_name": "filter_1",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "filter",
                        "status": "",
                        "type": "coa.Filter",
                        "warn": false,
                        "z": 71
                    },
                    {
                        "active": false,
                        "angle": 0,
                        "attrs": {
                            ".background": {
                                "fill": "#000000",
                                "stroke": "#637282",
                                "transform": "rotate(45 30 70)"
                            },
                            ".inPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "in",
                                    "type": "in"
                                }
                            },
                            ".number": {
                                "text": 2
                            },
                            ".outPorts>.port-0": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                },
                                "ref-x": 83,
                                "ref-y": 40
                            },
                            ".outPorts>.port-0>.port-body": {
                                "port": {
                                    "id": "out-1",
                                    "type": "out"
                                }
                            },
                            ".outPorts>.port-1": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                },
                                "ref-x": 41,
                                "ref-y": 82
                            },
                            ".outPorts>.port-1>.port-body": {
                                "port": {
                                    "id": "out-2",
                                    "type": "out"
                                }
                            },
                            "g.delete": {
                                "display": "none"
                            },
                            "g.error": {
                                "opacity": 0
                            },
                            "g.error image": {
                                "xlink:href": "/inc/coa/img/block_icon_warn.svg"
                            },
                            "g.notes": {
                                "display": "block"
                            },
                            "g.notes image": {
                                "opacity": 1
                            }
                        },
                        "block_code": "def decision_2(action=None, success=None, container=None, results=None, handle=None, filtered_artifacts=None, filtered_results=None, custom_function=None, **kwargs):\n    phantom.debug('decision_2() called')\n\n    # check for 'if' condition 1\n    matched = phantom.decision(\n        container=container,\n        action_results=results,\n        conditions=[\n            [\"artifact:*.cef.destinationHostName\", \"==\", \"\"],\n        ])\n\n    # call connected blocks if condition 1 matched\n    if matched:\n        CompleteTaskNoArtifacts(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n        return\n\n    # call connected blocks for 'else' condition 2\n    filter_1(action=action, success=success, container=container, results=results, handle=handle, custom_function=custom_function)\n\n    return\n",
                        "callback_code": "",
                        "callback_start": 1,
                        "callsback": false,
                        "connected_to_start": true,
                        "connection_name": "TaskInProgress",
                        "connection_type": "action",
                        "custom_callback": "",
                        "custom_code": "",
                        "custom_join": "",
                        "custom_name": "",
                        "description": "",
                        "hasElse": true,
                        "has_custom": false,
                        "has_custom_block": false,
                        "has_custom_callback": false,
                        "has_custom_join": false,
                        "id": "ea5f315e-8152-4ecc-9ee5-d850f072d3e7",
                        "inPorts": [
                            "in"
                        ],
                        "join_code": "",
                        "join_optional": [],
                        "join_start": 1,
                        "line_end": 168,
                        "line_start": 147,
                        "name": "decision",
                        "notes": "",
                        "number": 2,
                        "order": 7,
                        "outPorts": [
                            "out-1",
                            "out-2"
                        ],
                        "outputs": [
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "artifact:*.cef.destinationHostName",
                                        "value": ""
                                    }
                                ],
                                "display": "If",
                                "logic": "and",
                                "type": "if"
                            },
                            {
                                "conditions": [
                                    {
                                        "comparison": "==",
                                        "data_type": "",
                                        "param": "",
                                        "value": ""
                                    }
                                ],
                                "display": "Else",
                                "logic": "and",
                                "type": "else"
                            }
                        ],
                        "ports": {
                            "groups": {
                                "in": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "left"
                                        }
                                    },
                                    "position": {
                                        "name": "left"
                                    }
                                },
                                "out": {
                                    "attrs": {
                                        ".port-body": {
                                            "fill": "#fff",
                                            "magnet": true,
                                            "r": 10,
                                            "stroke": "#000"
                                        },
                                        ".port-label": {
                                            "fill": "#000"
                                        }
                                    },
                                    "label": {
                                        "position": {
                                            "args": {
                                                "y": 10
                                            },
                                            "name": "right"
                                        }
                                    },
                                    "position": {
                                        "name": "right"
                                    }
                                }
                            }
                        },
                        "position": {
                            "x": 260,
                            "y": 220
                        },
                        "previous_function": "",
                        "previous_name": "decision_2",
                        "show_number": true,
                        "size": {
                            "height": 82,
                            "width": 82
                        },
                        "state": "decision",
                        "status": "",
                        "type": "coa.Decision",
                        "warn": "",
                        "z": 72
                    }
                ]
            },
            "notes": ""
        },
        "python_version": "3",
        "schema": 4,
        "version": "4.10.3.51237"
    },
    "create_time": "2021-07-27T11:24:06.425869+00:00",
    "draft_mode": false,
    "labels": [
        "*"
    ],
    "tags": []
}