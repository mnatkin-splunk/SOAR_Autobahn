{
    "name": "POV_Malware_Investigation_Workbook",
    "description": "This workbook is designed to use the Enterprise Security - ESCU Detect Rare Process Notable with the Proof of Value phase. However, It can also be used to triage and perform an initial investigation of any suspicious executable..",
    "phases": [
        {
            "id": "new-phase1",
            "name": "Identification",
            "order": 1,
            "sla": null,
            "sla_type": "minutes",
            "tasks": [
                {
                    "id": "new-task1",
                    "name": "Accept Task and Assign Owner",
                    "order": 1,
                    "owner": null,
                    "role": null,
                    "description": "The first step in the workbook - Take ownership of the event, and set the status from new to open.",
                    "playbooks": [
                            {
                                "scm": "local",
                                "playbook": "POV_Accept_Event"
                            }
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task2",
                    "name": "Perform Manual Inspection",
                    "order": 2,
                    "owner": null,
                    "role": null,
                    "description": "Perform an initial inspection looking for obvious signs the executable is either suspicious or benign. Executables with the right name but wrong working directory, or lookalike file names running from the right directory, but wrong name (svcnost.exe, scvhost.exe etc) may be examples or files that should be investigated further. \n\nAny file deemed to be benign, and expected within your environment, should be whitelisted as part of the initial SIEM detection. \n\nUpdate the task notes with your initial findings, and close the event if necessary.",
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task3",
                    "name": "Perform Initial Triage on file Hash",
                    "order": 3,
                    "owner": null,
                    "role": null,
                    "description": "Regardless of whether the identification of suspicious executables come from internal threat hunting, service desk calls or externally reported, perform an initial triage by performing a file reputation lookup and obtaining an initial view.",
                    "actions": [
                            "file reputation"
                        ],
                        "playbooks": [
                            {
                                "scm": "local",
                                "playbook": "POV_File_Reputation"
                            }
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task4",
                    "name": "Add Context from Active Directory",
                    "order": 4,
                    "owner": null,
                    "role": null,
                    "description": "Lookup the reported device in Active Directory for more context. This playbook adds fields to the artifacts with the field destinationHostName set along with general and task notes.",
                    "actions": [
                            "get system info"
                        ],
                        "playbooks": [
                            {
                                "scm": "local",
                                "playbook": "POV_Get_Sys_Info_LDAP"
                            }
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task5",
                    "name": "Gather Suspicious Executable",
                    "order": 5,
                    "owner": null,
                    "role": null,
                    "description": "If the executable warrants further investigation, obtain a copy of it from the host computer using the fileHash if using products such as CarbonBlack, or by filePath if connecting directly to the host.",
                    "actions": [
                            "get file"
                        ],
                        "playbooks": [
                            {
                                "scm": "local",
                                "playbook": "POV_WinRM_Get_File"
                            }
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task6",
                    "name": "Detonate File",
                    "order": 6,
                    "owner": null,
                    "role": null,
                    "description": "If required, discover the behaviour of the executable by sending it to a detonation sandbox, either externally or internally.",
                    "actions": [
                            "detonate file"
                        ],
                        "playbooks": [
                            {
                                "scm": "local",
                                "playbook": "POV_Detonate_Executable_File"
                            }
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task7",
                    "name": "Gather SIEM Context",
                    "order": 7,
                    "owner": null,
                    "role": null,
                    "description": "Use 'off-host' techniques to investigate the host in question, specifically looking for signs of lateral movement, command and control (C2), and other signs of suspicious process execution.",
                    "playbooks": [
                            {
                                "scm": "local",
                                "playbook": "POV_SIEM_Context"
                            }
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task8",
                    "name": "Make a Determination - Tag Event",
                    "order": 8,
                    "owner": null,
                    "role": null,
                    "description": "Based on artefacts collected to make a determination as to whether this is unwanted malicious software. If not tag the event 'benign'. If benign consider how SIEM detection can be better tuned to provide a better false-positive rate without negatively impacting the false-negative rate.\n\nIf this is deemed malicious, tag the event 'malware' and make a determination as to the classification of the malware. Examples include spyware, adware, worm, trojan, crypto-mining, keylogger, virus etc. Tag the event appropriately.",
                    "actions": [
                            "add tag"
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task9",
                    "name": "Gather Live Response Artefacts",
                    "order": 9,
                    "owner": null,
                    "role": null,
                    "description": "If this host has been determined as having active malware present, begin a collection of live artefacts to begin to understand in detail how the host has been compromised and what other systems may have been affected.",
                    "actions": [
                            "run command"
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task10",
                    "name": "Develop Cyber Threat Intelligence",
                    "order": 10,
                    "owner": null,
                    "role": null,
                    "description": "As you identify interesting information create artefacts with a name of 'Evidence', create notes, and files. Mark as evidence by clicking 'Mark as Evidence'.\n\nUse this information to identify TTPs for later consumption later phases.",
                    "actions": [
                            "add note",
                            "add artifact"
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task11",
                    "name": "Get Enterprise Patch Status",
                    "order": 11,
                    "owner": null,
                    "role": null,
                    "description": "If the malicious software is taking advantage of a known vulnerability, list hosts that are currently unpatched against it.",
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task12",
                    "name": "Perform Targeted or Enterprise Wide Scan",
                    "order": 12,
                    "owner": null,
                    "role": null,
                    "description": "Look for evidence of the malware on other hosts in the network, or signs of compromise using the evidence and information gathered so far. Malware may not be present all compromised hosts. Using evidence gathered from previous steps should be used to perform sweeps or targeted scans.\n\nAdd these hosts to the case to broaden and inform the response plan.",
                    "actions": [
                            "run query",
                            "run command"
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                }
            ]
        },
        {
            "id": "new-phase2",
            "name": "Containment",
            "order": 2,
            "sla": null,
            "sla_type": "minutes",
            "tasks": [
                {
                    "id": "new-task13",
                    "name": "Add User Accounts to Watchlist",
                    "order": 1,
                    "owner": null,
                    "role": null,
                    "description": "Increase activity monitoring for accounts of interest in Enterprise Security using the watchlist feature to help identify any further abuse using known credentials.",
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task14",
                    "name": "Restrict External Network Connectivity",
                    "order": 2,
                    "owner": null,
                    "role": null,
                    "description": "Degrade the intruder's capability to communicate or exfiltrate data externally by restricting URLs, IPs and Domains to the Internet, by blocking or sinkhole indicators.",
                    "actions": [
                            "block ip"
                        ],
                        "playbooks": [],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task15",
                    "name": "Restrict Internal Network Connectivity",
                    "order": 3,
                    "owner": null,
                    "role": null,
                    "description": "Degrade the intruder's ability to move laterally across hosts by restricting internal ports, and URLs.",
                    "actions": [
                            "block ip"
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task16",
                    "name": "Restrict Host Execution",
                    "order": 4,
                    "owner": null,
                    "role": null,
                    "description": "Degrade the intruder's capability to run known executables by blocking file hashes or executable paths.",
                    "actions": [
                            "block file path",
                            "block hash"
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task17",
                    "name": "Patch Vulnerable Hosts",
                    "order": 5,
                    "owner": null,
                    "role": null,
                    "description": "If a specific vulnerability has been identified as exploited by the malware, patch any hosts that are currently also vulnerable to prevent further spread using this specific technique.",
                    "actions": [],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                }
            ]
        },
        {
            "id": "new-phase3",
            "name": "Remediation",
            "order": 3,
            "sla": null,
            "sla_type": "minutes",
            "tasks": [
                {
                    "id": "new-task18",
                    "name": "Clean or Rebuild Compromised Systems",
                    "order": 1,
                    "owner": null,
                    "role": null,
                    "description": "Depending on the nature of the incident consider how to remediate the affected hosts. This may include simply cleaning the host(s) by removing the malware or completely rebuilding.",
                    "actions": [
                            "send email",
                            "create ticket"
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task19",
                    "name": "Password Resets",
                    "order": 2,
                    "owner": null,
                    "role": null,
                    "description": "Depending on the nature of the incident, reset passwords for the known compromised account(s) or consider an enterprise-wide password reset if deemed appropriate.",
                    "actions": [
                            "reset password",
                            "send email",
                            "create ticket"
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task20",
                    "name": "Verify all Remediation Activities",
                    "order": 3,
                    "owner": null,
                    "role": null,
                    "description": "Verify that all remediation activities have been conducted. Failure to completely eradicate a determined adversary will lead to further incidents likely using new techniques to need to be rediscovered.",
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                }
            ]
        },
        {
            "id": "new-phase4",
            "name": "Recovery",
            "order": 4,
            "sla": null,
            "sla_type": "minutes",
            "tasks": [
                {
                    "id": "new-task21",
                    "name": "Remove Restricted Internal Network Communication",
                    "order": 1,
                    "owner": null,
                    "role": null,
                    "description": "Unblock ports, and URLs that were previously containing the intruder's activities",
                    "actions": [
                            "unblock hash",
                            "block ip"
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task22",
                    "name": "Send Malware for Reverse Engineering",
                    "order": 2,
                    "owner": null,
                    "role": null,
                    "description": "",
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task23",
                    "name": "Breach Notification",
                    "order": 3,
                    "owner": null,
                    "role": null,
                    "description": "What type of data has been compromised? If regulatory data - what notification requirements exist? If appropriate raise the incident with the appropriate group(s) within the organisation.",
                    "actions": [
                            "send email",
                            "create ticket",
                            "update ticket"
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                }
            ]
        },
        {
            "id": "new-phase5",
            "name": "Lessons Learnt",
            "order": 5,
            "sla": null,
            "sla_type": "minutes",
            "tasks": [
                {
                    "id": "new-task24",
                    "name": "Develop Incident Report",
                    "order": 1,
                    "owner": null,
                    "role": null,
                    "description": "Generate an Incident Report using the 'Reports' function in Phantom and if appropriate attach to an existing ticketing system.",
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task25",
                    "name": "Conduct Lessons Learnt",
                    "order": 2,
                    "owner": null,
                    "role": null,
                    "description": "If deemed appropriate conduct lessons learnt exercise(s), to improve the response template and plan for future incidents.",
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                },
                {
                    "id": "new-task26",
                    "name": "Close Event",
                    "order": 3,
                    "owner": null,
                    "role": null,
                    "description": "Close.",
                    "playbooks": [
                            {
                                "scm": "local",
                                "playbook": "POV_Close_Event"
                            }
                        ],
                    "is_note_required": true,
                    "sla": null,
                    "sla_type": "minutes"
                }
            ]
        }
    ]
}